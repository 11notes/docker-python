name: wheel
on:
  workflow_dispatch:
    inputs:
      version:
        description: 'set version for wheel'
        type: string
        required: true
jobs:
  wheel:
    runs-on: ubuntu-latest
    steps:
      # ╔═════════════════════════════════════════════════════╗
      # ║               BUILD VERSION {N} IMAGE               ║
      # ╚═════════════════════════════════════════════════════╝
      - name: semver / setup config
        uses: actions/github-script@62c3794a3eb6788d9a2a72b219504732c0c9a298
        with:
          script: |
            const { Buffer } = require('node:buffer');
            const etc = {
              dockerfile:"wheel.dockerfile",
              tag:"wheel",
              version:"${{ github.event.inputs.version }}",
              semver:{disable:{rolling: true}}
            };
            core.exportVariable('WORKFLOW_BASE64JSON', Buffer.from(JSON.stringify(etc)).toString('base64'));

      - name: semver / build container image
        uses: the-actions-org/workflow-dispatch@3133c5d135c7dbe4be4f9793872b6ef331b53bc7
        with:
          wait-for-completion: false
          workflow: docker.yml
          token: "${{ secrets.REPOSITORY_TOKEN }}"
          inputs: '{ "release":"false", "readme":"false", "etc":"${{ env.WORKFLOW_BASE64JSON }}" }'